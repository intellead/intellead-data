{"version":3,"sources":["../../../lib/doc/row.js"],"names":["_","require","Enums","colCache","Cell","Row","module","exports","worksheet","number","_worksheet","_number","_cells","style","outlineLevel","prototype","commit","_commitRow","destroy","findCell","colNumber","getCellEx","address","cell","col","column","getColumn","getCell","getColumnKey","l2n","encodeAddress","row","splice","start","count","inserts","Array","slice","call","arguments","nKeep","nExpand","length","nEnd","i","cSrc","cDst","value","undefined","eachCell","options","iteratee","includeEmpty","n","forEach","index","type","ValueType","Null","values","offset","hasOwnProperty","item","eachColumnKey","key","hasValues","some","cellCount","actualCellCount","dimensions","min","max","_applyStyle","name","numFmt","font","alignment","border","fill","hidden","_hidden","_outlineLevel","collapsed","properties","outlineLevelRow","model","cells","cellModel","push","height","Error","Types","Merge","decodeAddress"],"mappings":"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","file":"row.js","sourcesContent":["/**\r\n * Copyright (c) 2014-2017 Guyon Roche\r\n * LICENCE: MIT - please refer to LICENCE file included with this module\r\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\r\n */\r\n\r\n'use strict';\r\n\r\nvar _ = require('../utils/under-dash');\r\n\r\nvar Enums = require('./enums');\r\nvar colCache = require('./../utils/col-cache');\r\nvar Cell = require('./cell');\r\n\r\nvar Row = module.exports = function(worksheet, number) {\r\n  this._worksheet = worksheet;\r\n  this._number = number;\r\n  this._cells = [];\r\n  this.style = {};\r\n  this.outlineLevel = 0;\r\n};\r\n\r\nRow.prototype = {\r\n  // return the row number\r\n  get number() {\r\n    return this._number;\r\n  },\r\n\r\n  get worksheet() {\r\n    return this._worksheet;\r\n  },\r\n\r\n  // Inform Streaming Writer that this row (and all rows before it) are complete\r\n  // and ready to write. Has no effect on Worksheet document\r\n  commit: function() {\r\n    this._worksheet._commitRow(this); // eslint-disable-line no-underscore-dangle\r\n  },\r\n\r\n  // helps GC by breaking cyclic references\r\n  destroy: function() {\r\n    delete this._worksheet;\r\n    delete this._cells;\r\n    delete this.style;\r\n  },\r\n\r\n  findCell: function(colNumber) {\r\n    return this._cells[colNumber - 1];\r\n  },\r\n\r\n  // given {address, row, col}, find or create new cell\r\n  getCellEx: function(address) {\r\n    var cell = this._cells[address.col - 1];\r\n    if (!cell) {\r\n      var column = this._worksheet.getColumn(address.col);\r\n      cell = new Cell(this, column, address.address);\r\n      this._cells[address.col - 1] = cell;\r\n    }\r\n    return cell;\r\n  },\r\n\r\n  // get cell by key, letter or column number\r\n  getCell: function(col) {\r\n    if (typeof col === 'string') {\r\n      // is it a key?\r\n      var column = this._worksheet.getColumnKey(col);\r\n      if (column) {\r\n        col = column.number;\r\n      } else {\r\n        col = colCache.l2n(col);\r\n      }\r\n    }\r\n    return this._cells[col - 1] ||\r\n      this.getCellEx({\r\n        address: colCache.encodeAddress(this._number, col),\r\n        row: this._number,\r\n        col: col\r\n      });\r\n  },\r\n\r\n  // remove cell(s) and shift all higher cells down by count\r\n  splice: function(start, count) {\r\n    var inserts = Array.prototype.slice.call(arguments, 2);\r\n    var nKeep = start + count;\r\n    var nExpand = inserts.length - count;\r\n    var nEnd = this._cells.length;\r\n    var i, cSrc, cDst;\r\n    if (nExpand < 0) {\r\n      // remove cells\r\n      for (i = nKeep; i <= nEnd; i++) {\r\n        cSrc = this._cells[i - 1];\r\n        if (cSrc) {\r\n          this.getCell(i + nExpand).value = cSrc.value;\r\n          cSrc.value = null;\r\n        } else {\r\n          cDst = this._cells[(i + nExpand) - 1];\r\n          if (cDst) {\r\n            cDst.value = null;\r\n          }\r\n        }\r\n      }\r\n    } else if (nExpand > 0) {\r\n      // insert new cells\r\n      for (i = nEnd; i >= nKeep; i--) {\r\n        cSrc = this._cells[i - 1];\r\n        if (cSrc) {\r\n          this.getCell(i + nExpand).value = cSrc.value;\r\n        } else {\r\n          this._cells[(i + nExpand) - 1] = undefined;\r\n        }\r\n      }\r\n    }\r\n\r\n    // now add the new values\r\n    for (i = 0; i < inserts.length; i++) {\r\n      this.getCell(start + i).value = inserts[i];\r\n    }\r\n  },\r\n\r\n  // Iterate over all non-null cells in this row\r\n  eachCell: function(options, iteratee) {\r\n    if (!iteratee) {\r\n      iteratee = options;\r\n      options = null;\r\n    }\r\n    if (options && options.includeEmpty) {\r\n      var n = this._cells.length;\r\n      for (var i = 1; i <= n; i++) {\r\n        iteratee(this.getCell(i), i);\r\n      }\r\n    } else {\r\n      this._cells.forEach(function(cell, index) {\r\n        if (cell && (cell.type !== Enums.ValueType.Null)) {\r\n          iteratee(cell, index + 1);\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  // return a sparse array of cell values\r\n  get values() {\r\n    var values = [];\r\n    this._cells.forEach(function(cell) {\r\n      if (cell && (cell.type !== Enums.ValueType.Null)) {\r\n        values[cell.col] = cell.value;\r\n      }\r\n    });\r\n    return values;\r\n  },\r\n\r\n  // set the values by contiguous or sparse array, or by key'd object literal\r\n  set values(value) {\r\n    // this operation is not additive - any prior cells are removed\r\n    this._cells = [];\r\n    if (!value) {\r\n      // empty row\r\n    } else if (value instanceof Array) {\r\n      var offset = 0;\r\n      if (value.hasOwnProperty('0')) {\r\n        // contiguous array - start at column 1\r\n        offset = 1;\r\n      }\r\n      value.forEach((item, index) => {\r\n        if (item !== undefined) {\r\n          this.getCellEx({\r\n            address: colCache.encodeAddress(this._number, index + offset),\r\n            row: this._number,\r\n            col: index + offset\r\n          }).value = item;\r\n        }\r\n      });\r\n    } else {\r\n      // assume object with column keys\r\n      this._worksheet.eachColumnKey((column, key) => {\r\n        if (value[key] !== undefined) {\r\n          this.getCellEx({\r\n            address: colCache.encodeAddress(this._number, column.number),\r\n            row: this._number,\r\n            col: column.number\r\n          }).value = value[key];\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  // returns true if the row includes at least one cell with a value\r\n  get hasValues() {\r\n    return _.some(this._cells, function(cell) {\r\n      return cell && (cell.type !== Enums.ValueType.Null);\r\n    });\r\n  },\r\n\r\n  get cellCount() {\r\n    return this._cells.length;\r\n  },\r\n  get actualCellCount() {\r\n    var count = 0;\r\n    this.eachCell(function() {\r\n      count++;\r\n    });\r\n    return count;\r\n  },\r\n\r\n  // get the min and max column number for the non-null cells in this row or null\r\n  get dimensions() {\r\n    var min = 0;\r\n    var max = 0;\r\n    this._cells.forEach(function(cell) {\r\n      if (cell && (cell.type !== Enums.ValueType.Null)) {\r\n        if (!min || (min > cell.col)) {\r\n          min = cell.col;\r\n        }\r\n        if (max < cell.col) {\r\n          max = cell.col;\r\n        }\r\n      }\r\n    });\r\n    return min > 0 ? {\r\n      min: min,\r\n      max: max\r\n    } : null;\r\n  },\r\n\r\n  // =========================================================================\r\n  // styles\r\n  _applyStyle: function(name, value) {\r\n    this.style[name] = value;\r\n    this._cells.forEach(function(cell) {\r\n      if (cell) { cell[name] = value; }\r\n    });\r\n    return value;\r\n  },\r\n\r\n  get numFmt() {\r\n    return this.style.numFmt;\r\n  },\r\n  set numFmt(value) {\r\n    this._applyStyle('numFmt', value);\r\n  },\r\n  get font() {\r\n    return this.style.font;\r\n  },\r\n  set font(value) {\r\n    this._applyStyle('font', value);\r\n  },\r\n  get alignment() {\r\n    return this.style.alignment;\r\n  },\r\n  set alignment(value) {\r\n    this._applyStyle('alignment', value);\r\n  },\r\n  get border() {\r\n    return this.style.border;\r\n  },\r\n  set border(value) {\r\n    this._applyStyle('border', value);\r\n  },\r\n  get fill() {\r\n    return this.style.fill;\r\n  },\r\n  set fill(value) {\r\n    this._applyStyle('fill', value);\r\n  },\r\n\r\n  get hidden() {\r\n    return !!this._hidden;\r\n  },\r\n  set hidden(value) {\r\n    this._hidden = value;\r\n  },\r\n\r\n  get outlineLevel() {\r\n    return this._outlineLevel || 0;\r\n  },\r\n  set outlineLevel(value) {\r\n    this._outlineLevel = value;\r\n  },\r\n  get collapsed() {\r\n    return !!(this._outlineLevel && (this._outlineLevel >= this._worksheet.properties.outlineLevelRow));\r\n  },\r\n\r\n  // =========================================================================\r\n  get model() {\r\n    var cells = [];\r\n    var min = 0;\r\n    var max = 0;\r\n    this._cells.forEach(function(cell) {\r\n      if (cell) {\r\n        var cellModel = cell.model;\r\n        if (cellModel) {\r\n          if (!min || (min > cell.col)) {\r\n            min = cell.col;\r\n          }\r\n          if (max < cell.col) {\r\n            max = cell.col;\r\n          }\r\n          cells.push(cellModel);\r\n        }\r\n      }\r\n    });\r\n\r\n    return (this.height || cells.length) ? {\r\n      cells: cells,\r\n      number: this.number,\r\n      min: min,\r\n      max: max,\r\n      height: this.height,\r\n      style: this.style,\r\n      hidden: this.hidden,\r\n      outlineLevel: this.outlineLevel,\r\n      collapsed: this.collapsed\r\n    } : null;\r\n  },\r\n  set model(value) {\r\n    if (value.number !== this._number) {\r\n      throw new Error('Invalid row number in model');\r\n    }\r\n    this._cells = [];\r\n    value.cells.forEach(cellModel => {\r\n      switch (cellModel.type) {\r\n        case Cell.Types.Merge:\r\n          // special case - don't add this types\r\n          break;\r\n        default:\r\n          var cell = this.getCellEx(colCache.decodeAddress(cellModel.address));\r\n          cell.model = cellModel;\r\n          break;\r\n      }\r\n    });\r\n\r\n    if (value.height) {\r\n      this.height = value.height;\r\n    } else {\r\n      delete this.height;\r\n    }\r\n\r\n    this.hidden = value.hidden;\r\n    this.outlineLevel = value.outlineLevel || 0;\r\n\r\n    this.style = value.style || {};\r\n  }\r\n};\n"]}